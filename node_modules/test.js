const axios = require('axios');
const crypto = require('crypto'); // Pas besoin d'installation

// Tes clés API
const API_KEY = "bg_47d37f908a76a456d300ff9b5977758e";
const API_SECRET = "155a1ab337d4b35f80cbd8a2abdfac3f85f0e514f3b0b340445c28306126cba7";
const PASSPHRASE = "6vANCE6NK6RaY"; // Si applicable

const BASE_URL = "https://api.bitget.com";
const ENDPOINT = "/api/spot/v1/account/assets";

// Générer l'en-tête HMAC
function generateHeaders(method, endpoint, query = "") {
    const timestamp = Date.now().toString();
    const prehash = timestamp + method.toUpperCase() + endpoint + query;
    const signature = crypto.createHmac('sha256', API_SECRET)
                            .update(prehash)
                            .digest('hex');

    return {
        'Content-Type': 'application/json',
        'ACCESS-KEY': API_KEY,
        'ACCESS-SIGN': signature,
        'ACCESS-TIMESTAMP': timestamp,
        'ACCESS-PASSPHRASE': PASSPHRASE,
    };
}

// Requête GET pour récupérer les actifs
async function fetchAssets() {
    try {
        const headers = generateHeaders("GET", ENDPOINT);
        const response = await axios.get(BASE_URL + ENDPOINT, { headers });
        console.log(response.data);
    } catch (error) {
        console.error("Erreur :", error.message);
    }
}

fetchAssets();